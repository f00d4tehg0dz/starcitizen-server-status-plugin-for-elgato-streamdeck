<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Settings</title>
    <script src="https://sdpi-components.dev/releases/v3/sdpi-components.js"></script>
</head>
<body>
    <sdpi-item label="Automatic Refresh">
        <sdpi-checkbox setting="automaticRefresh"></sdpi-checkbox>
    </sdpi-item>
    
    <sdpi-item label="Show">
        <sdpi-select id="field0" setting="displayMode" placeholder="Select Option">
            <option value="status">Server Status</option>
            <option value="stats">Stats</option>
            <!-- <option value="tracker">Tracker</option> -->
        </sdpi-select>
    </sdpi-item>
    <sdpi-item>
        <sdpi-button id="updateBtn">Update</sdpi-button>
    </sdpi-item>

    <sdpi-item label="Username">
        <sdpi-textfield id="username" setting="username" placeholder="Enter Username"></sdpi-textfield>
        <sdpi-button id="usernameBtn">Search</sdpi-button>
    </sdpi-item>

    <sdpi-item label="Ship Info">
        <sdpi-textfield id="shipInfo" setting="shipInfo" placeholder="Enter Ship Info"></sdpi-textfield>
        <sdpi-button id="shipInfoBtn">View</sdpi-button>
    </sdpi-item>

    

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("DOM fully loaded and parsed");
            const displayModeSelect = document.getElementById('field0');
            const usernameSelect = document.getElementById('username');
            const shipInfoSelect = document.getElementById('shipInfo');
            const usernameButton = document.getElementById('usernameBtn');
            const shipInfoButton = document.getElementById('shipInfoBtn');
            const updateButton = document.getElementById('updateBtn');

            if (updateButton) {
                updateButton.addEventListener('click', function () {
                    if (displayModeSelect) {
                        const selectedValue = displayModeSelect.value;
                        const settings = {
                            displayMode: selectedValue,
                            // Add other settings if needed
                        };

                        console.log("Updating settings with display mode:", selectedValue);
                        // Send the updated settings to the plugin
                        const { streamDeckClient } = SDPIComponents;
                        streamDeckClient.setSettings(settings);
                    } else {
                        console.error("Dropdown element not found");
                    }
                });
            } else {
                console.error("Update button not found");
            }

            if (usernameButton) {
                usernameButton.addEventListener('click', function () {
                    if (usernameSelect) {
                        const selectedValue = usernameSelect.value;
                        const settings = {
                            username: selectedValue,
                            displayMode: 'username',
                            // Add other settings if needed
                        };

                        console.log("Updating settings with display mode:", selectedValue);
                        // Send the updated settings to the plugin
                        const { streamDeckClient } = SDPIComponents;
                        streamDeckClient.setSettings(settings);
                    } else {
                        console.error("Dropdown element not found");
                    }
                });
            } else {
                console.error("Update button not found");
            }

            if (shipInfoButton) {
                shipInfoButton.addEventListener('click', function () {
                    if (shipInfoSelect) {
                        const selectedValue = shipInfoSelect.value;
                        const settings = {
                            shipInfo: selectedValue,
                            displayMode: 'ship'
                            // Add other settings if needed
                        };

                        console.log("Updating settings with display mode:", selectedValue);
                        // Send the updated settings to the plugin
                        const { streamDeckClient } = SDPIComponents;
                        streamDeckClient.setSettings(settings);
                    } else {
                        console.error("Dropdown element not found");
                    }
                });
            } else {
                console.error("Update button not found");
            }
        });
    </script>
</body>
</html>